import os
import logging
from typing import List, Dict, Any, Optional, Iterable, Tuple
from qdrant_client import QdrantClient, models
from dotenv import load_dotenv, dotenv_values 
from pathlib import Path


env_path = Path(__file__).resolve().parents[1] / ".env"
load_dotenv(dotenv_path=env_path)

class QdrantStore:
    """
    Simple Qdrant adapter with methods to list collections, upsert points and perform searches.
    """

    def __init__(
        self,
        url: Optional[str] = None,
        api_key: Optional[str] = None,
        default_collection: Optional[str] = None,
        prefer_grpc: bool = False,
    ):
        # you can override by passing values OR use env vars OR fallback to your constants
        self.url = os.getenv("QDRANT_URL") 

        self.api_key = os.getenv("QDRANT_API_KEY")
        print(self.api_key)
        print(self.url)

        self.default_collection = default_collection
        self.client = QdrantClient(url=self.url, api_key=self.api_key, prefer_grpc=prefer_grpc)
        logging.info("âœ… Connected to Vector DB")

    # --------------------- BASIC METHODS ---------------------

    def list_collections(self):
        """Return list of collections."""
        return self.client.get_collections()

    def upsert_vector(
        self,
        collection: str,
        vector_id: int,
        vector: List[float],
        payload: Dict[str, Any]
    ):
        """Insert/update a single vector."""
        point = models.PointStruct(
            id=vector_id,
            vector=vector,
            payload=payload
        )
        return self.client.upsert(collection_name=collection, points=[point])

    def search(
        self,
        collection: str,
        vector: List[float],
        limit: int,
        query_filter: Optional[models.Filter] = None
    ):
        """Search using the high-level search API."""
        results = self.client.query_points(
            collection_name=collection,
            query=vector,
            limit=limit,
            query_filter=query_filter,
            with_payload=True
            ##search_params=search_params,
        )
        filtered_points = [p for p in results.points if p.score >= 0.85]


        return filtered_points
        

    def query_points(
        self,
        collection: str,
        vector: List[float],
        limit: int = 10,
        query_filter: Optional[models.Filter] = None
        ##search_params: Optional[models.SearchParams] = None
    ):
        """Use the low-level legacy query_points API."""
        return self.client.query_points(
            collection_name=collection,
            query=vector,
            limit=limit,
            query_filter=query_filter,
            ##search_params=search_params,
        )
    def extract_solutions(results):

        solutions = []
        for index, point in enumerate(results, start=1):
            solution_text = point.payload.get("solution", "")
            solutions.append(f"solution{index}: {solution_text}")

        return "\n".join(solutions)


# --------------------- USAGE EXAMPLE ---------------------

#if __name__ == "__main__":

    ##store = QdrantStore()

    # list collections
    ##print("Collections:", store.list_collections())

    # -------------------------------------
    # Upsert single vector (your working code)
    # -------------------------------------
    '''store.upsert_vector(
        collection="error_solutions",
        vector_id=3,
        vector= [-0.08517057,0.013645453,0.017656362,0.07727124,0.043820716,0.031081298,0.0075638797,0.0771054,0.04238752,-0.01727521,0.0036819254,0.01524244,0.055600926,0.019411314,0.08420294,0.033399228,-0.0059207547,0.006911322,-0.042518593,0.0168469,0.0551168,-0.0053817225,0.0017880454,-0.041658387,-0.013086695,0.06849941,0.014804731,-0.02978741,1.6894E-4,-0.045686178,-0.018216077,0.011939476,0.029255388,-0.019138603,0.024569858,0.0038818645,-8.4143874E-5,-0.053904828,0.030048188,0.0661481,-0.035670508,0.031794045,-0.038949803,-0.012637211,0.020938398,-0.041362874,-0.055037487,-0.028256947,-0.028176956,0.030392246,-0.06948778,0.032395065,-0.03230184,-0.01467375,-0.0646774,0.004111532,0.046952095,-0.019336376,-0.099258095,0.0076207975,-0.08019748,-0.054852907,0.03129267,0.001074702,0.018806417,-0.021240242,-0.017082622,0.040913284,-0.015161365,0.188269,-0.03224139,-0.0056727882,-0.018633787,-0.07903677,0.21516383,0.016145049,0.0047517386,-0.008120546,-0.06223,-0.019829338,0.03447871,0.014934799,-3.3774934E-4,-0.031922586,0.049920917,0.0070763347,-0.034986332,-0.005773242,0.04691143,-0.030623786,4.6204217E-4,0.010685154,-4.032058E-4,-0.029639594,-0.014944007,-0.04626348,0.010569266,-0.019439025,0.027891954,0.046962637,-0.006691332,-0.025163759,0.043426756,0.09828776,0.005386337,-0.02737004,-0.027552994,-0.021713212,-0.05591223,0.02539598,-0.038012754,0.04890124,-0.018991208,-0.052367028,-0.034827475,0.0127029475,0.028141111,-0.0022910605,0.049230754,0.026020505,0.008103219,-0.014484352,0.02644289,0.04168442,0.032479785,0.021440964,0.005963157,0.015527083,0.001396051,0.009333179,0.013975816,0.036052074,0.017570363,0.05197067,0.03140246,0.008325922,0.006654964,0.026702186,0.03671377,-0.03025504,0.0014755096,0.0654022,0.013911756,0.014502271,-0.016952526,0.026338799,-0.010822083,-0.044984058,0.039829332,0.04700395,0.041063443,0.0034973891,0.058565065,-0.016766552,-0.03017622,0.036708884,-0.0027410688,-0.011813435,-0.043551926,-0.033363946,-0.03578625,0.002304418,0.028481515,0.012495261,0.057734143,0.10029606,-0.028084131,0.050265063,0.018670324,-0.015797956,-0.042026397,-0.022371981,0.03097342,-0.025949886,-0.03763185,0.004711166,-0.037874028,-0.023722485,0.054324485,0.06475405,0.006257331,0.054235,0.009285318,-0.005790962,-0.005331061,0.03578564,0.009309046,0.05547403,0.001807208,-0.066900514,0.0127014285,0.0030393268,0.013666703,0.011793851,-0.01533822,0.063146144,0.03591252,-0.006339484,-0.0064218077,0.006258839,0.019567026,-0.01055713,-0.015829287,-0.02630127,-0.01706165,0.02784055,0.039258398,0.014877103,-0.022570826,-9.4122996E-5,-0.022642653,0.07243301,-0.021968503,0.027606206,0.0047321143,0.032361116,-0.100642264,0.0042201197,0.032301538,-0.013497543,-0.008736028,0.054988693,0.002163836,0.021065844,-0.035834923,-0.034295436,-0.07103935,0.039566666,0.06364286,-0.040377323,0.0073780413,0.04226618,-0.048048902,0.037679516,-0.033865046,-0.040865168,-0.049685586,-0.01222325,0.023230335,0.052117974,0.07876111,0.02681096,-0.0031662052,-0.006973858,0.02130142,0.017608527,-0.0113977175,0.033935994,0.01250591,0.019359086,0.014675295,-0.0099246865,0.034751233,-0.0050181756,0.0027634362,-0.014063548,-0.003262738,-0.0068183253,0.068424284,0.010336599,0.038423628,0.008957154,-0.025101656,-0.034932047,0.04287424,0.022058163,0.02350555,-0.06902495,-0.07837638,0.0059340373,0.06808139,0.0044810413,-0.030874643,-0.037228175,-0.016379196,0.035902407,-0.082953446,-0.0043889685,0.041329876,-0.0049907686,-0.018274557,0.0036672205,-0.061809164,0.0047543556,-0.041155457,-4.531122E-4,0.04801629,-0.008046071,-0.05008985,-3.14303E-4,-6.109419E-6,-0.019164797,-0.026340118,-0.002563385,-0.0018910887,0.0018646048,-0.013959176,-0.054705728,-0.040693104,0.06469363,-0.10048395,-0.007904932,0.019099167,-0.006990846,0.0155600365,0.05089704,0.02853697,-4.7816997E-4,-0.018672302,0.049341723,-0.009203853,0.03159443,-0.030110613,-0.0029140639,0.005313065,0.05871788,0.044953257,-0.020722242,-4.5520614E-4,-0.008393037,-0.0020219388,0.006474721,-0.010953594,0.002198768,0.0049565993,0.031959366,0.024968907,-0.055375006,-0.10880959,0.013817057,-0.006306167,0.0067843264,0.004096858,0.010478215,-0.025159221,0.013477113,-0.017666807,-0.041403882,-0.0012953883,0.0066394387,-0.030064661,-0.038704008,0.035532583,0.019593323,0.031387698,0.079659395,-0.058361694,0.06574832,0.006583194,0.06726787,-0.014341496,-0.019374477,0.020357996,-0.0050838697,-0.017277483,-0.065980814,0.022068664,-0.002170413,-0.0011652117,0.00913782,0.062596224,-0.05753767,0.0054090433,-0.016297871,0.052465826,-0.015169184,-0.014210306,-0.007942404,0.031476002,0.019164987,0.049836755,-0.015949234,-0.017058082,-0.033080433,0.008119535,0.040121906,0.010431045,-0.04494644,0.01268281,-0.011011943,-0.084836416,0.0010797619,-0.01086273,0.02935452,0.04709691,0.03082127,0.0031600725,-0.02328911,-0.021170927,-0.0065747118,-0.083516434,-0.023615917,0.004824208,-0.015149098,0.027413828,-0.07092503,0.011448097,0.08544719,-0.008566277,0.03629963,0.023047686,2.0435166E-4,-0.023948994,-0.0033794388,0.00964442,-0.024247091,0.0038180144,-0.03429474,-0.0101267705,-0.020119574,0.0457766,-0.025510533,-0.052702006,0.033447646,0.040374186,-0.027283104,-0.01783971,0.007799421,-0.022107167,-0.0072187087,-0.05094435,0.04735807,0.07771974,-0.0054174815,0.039292842,0.034658194,-0.014630782,0.056024965,0.020421943,-0.029880596,0.027507138,-0.002210893,0.021214481,0.022818068,0.04205837,-0.016642844,-0.059119944,0.028533684,-0.019846873,0.013533144,0.018552586,-0.0035686148,0.05155227,-0.029664513,-0.026028285,-0.06295476,0.03423027,-0.026550839,-0.008778232,0.00841383,0.0026582526,0.04479979,-0.008050264,0.01659444,0.029411625,0.009094594,-0.0033623925,-0.009057532,-0.044726964,0.048625343,0.028604778,-0.008853571,0.0153795425,0.018141452,-0.0039758836,-0.030825686,0.005339551,-0.022828644,-0.049834862,-0.005937639,-0.059708077,0.012715941,0.019430427,0.04248778,0.036411468,0.017907796,0.004209201,-0.0034797296,0.04153343,0.034986533,-0.020204812,0.017695915,0.050375313,0.023019277,0.0011165224,-0.029275635,0.0166012,-0.015430035,-0.01441951,-0.015371682,0.04752616,0.068809934,-0.012559987,0.012944141,0.040048774,0.015549891,-0.05441374,0.03400027,-0.013079254,0.04542633,-0.0024528236,8.863734E-4,0.049113624,0.06586104,0.022133283,0.0030741203,0.014813018,-0.00482059,-0.03946342,-0.011578078,-0.007390458,-0.025023041,-0.01618458,0.008342595,0.023107948,-0.020024275,-0.0074892435,-0.002655948,0.02534334,0.015938602,0.023959477,-0.02253687,0.0045828256,0.01992165,0.039802283,0.00356514,0.00790723,0.039074168,0.052789696,-0.04683256,0.027938433,0.019324068,0.016253635,0.014876948,-0.014814728,-0.0015870987,-0.008778781,-0.04843967,0.019188099,0.013742721,0.020824166,-0.057516556,0.030022379,-0.01499478,0.038738754,0.007100978,0.013630862,-0.016165026,-0.025779458,0.037457433,0.0340485,-0.034975007,0.004496407,0.075062856,-0.021094667,0.01175735,-0.027392749,0.0072834436,0.032554734,0.070604645,-0.041488074,-0.0045166863,9.099685E-4,-0.014306071,-0.027798925,0.020153256,0.048091248,-0.020355728,-0.05016526,-0.0055938545,0.042413764,-0.031859748,0.0641612,-0.0019381526,-0.02815166,0.011260005,0.089147486,-0.009216827,0.009956428,0.0044349954,0.001955357,0.034142736,0.06530316,-0.021878991,0.07799853,0.022739463,-0.03934237,0.021132456,-0.0171426,-0.03725531,0.016088938,-0.05753499,-0.017458608,-0.036941126,0.0109438645,0.011318811,0.034330502,-0.047666226,0.02466111,-0.029940749,-0.01645759,0.027558926,-0.0034464167,0.027653832,0.062231805,0.040377706,0.029479496,0.05936185,0.018757623,0.015056836,-0.070708655,-0.027235458,-0.03347658,0.0039409483,-0.07381139,0.0011014629,-0.022351889,0.028618567,-0.009437129,0.0021218902,0.02845306,0.0054436354,0.0041131624,-0.03357439,0.033007484,0.022114843,0.048769243,-0.007145647,-0.023173131,0.041293044,-0.009825694,0.008957016,0.07849548,0.017319426,0.013487959,0.044494774,0.047377206,-0.08056526,-0.03052887,0.015762482,0.0048145256,0.042803727,0.005366723,0.018818889,0.025207995,-0.02755249,0.021617055,-0.020981153,-0.01698488,0.013714762,0.05631109,-0.008905265,0.0294522,-0.06891729,-0.028921725,0.011857348,-0.037572324,0.026536865,0.02490177,0.032233432,0.021692049,-0.053461168,-0.049327698,-0.047005754,-0.0775673,-0.040013123,-0.03568663,0.057111632,0.0051735905,-0.018120874,-0.01362229,0.03676257,-0.031602763,-0.034633305,-0.035508923,0.023148846,-8.9218456E-4,0.05237025,0.007792036,0.02786948,-0.0029690175,0.023887414,-0.047839522,-0.018213138,0.0016225388,-0.013213532,0.008516893,-0.010667247,-0.015313977,0.012342495,0.058113407,-0.024611631,0.01867602,-0.032439187,-0.016150288,0.017462602,0.06821641,-0.012826046,-0.046227667,0.017621804,0.08390134,0.023478242,0.06828969,-0.033230353,-0.028182138,0.053995296,-0.03132854,-0.061963834,-0.015837176,0.016075158,0.0373809,-0.0829834,0.011831921,0.0058914097,-0.034004,-0.012671819,0.042665962,-0.0034099997,-0.021069271,-0.019692777,0.018237624,0.019942291,0.009303045,-0.009290651,0.05828193,0.03540922,0.026647175,-0.036211994,-0.045808997,-0.052966267,-1.9813115E-5,-0.028811196,-0.06820883,-1.6323983E-4,-0.00585141,-0.0068851225,0.009853339,0.0037967642,0.039436236,-0.019851116,-0.037497543,-0.04986469,0.009961977,-0.012219999,0.05193779,-0.037166428,-0.030334443,-0.020686558,-0.07482921,-0.024725126,0.0060809436,-0.013911935,0.014164214,-0.025449425,-0.011735352,-0.019941943,-0.06438363,-0.0013454914,0.011034103,-0.023674697,-0.02878589,-0.0074877767,5.375846E-4,0.06145734,0.0036342365,-0.025760064,-0.058368012,-0.013363702],
        payload={
            "error_code": "SFTP:CONNECTIVITY",
            "error_description": "Connection timed out",
            "solution": "Check your network settings and ensure the SFTP server is reachable."
        }
    )'''

    # -------------------------------------
    # Query with filter (exactly like your code)
    # -------------------------------------
    '''store = QdrantStore()
    result = store.search(
        collection="error_solutions",
        vector = [-0.07094978,0.021390658,0.023612164,0.02114862,-0.04443448,0.027918097,-0.024966434,0.0484255,0.030663805,-0.03304073,0.0011082136,-0.005819045,-0.009710224,0.037831165,-0.057278402,0.04508901,0.01929249,0.11389614,-0.0018297938,-0.005280346,0.020714696,0.02467072,0.044924825,0.008169023,-0.010617606,0.022355326,0.040723767,0.007573998,-0.031731572,-0.04461482,-0.034104608,-0.03655395,0.043522354,0.05281755,0.020506978,-0.033817887,-0.057550475,-0.033038836,0.02586019,0.054101698,-0.04641186,0.0023336543,-0.010872172,-0.007092483,-0.0040996,-0.09006808,-0.049044397,-0.01137304,-0.029309493,-0.054121878,-0.011454708,0.115205355,-0.052466106,0.004350815,-0.038112395,0.026492309,-0.03382364,-0.023904257,-0.023075584,-0.085058376,-0.030486867,0.0051530064,-0.004566003,-0.009990741,-0.0145359775,-0.053534668,0.056742143,0.033408947,-0.0027713801,0.10987559,-0.02751103,-0.0126769105,-0.031882863,-0.029184042,0.17332391,0.033271495,-0.028087845,-0.008278943,-0.022880774,-0.015177153,0.045750372,0.045289576,-0.09162892,-0.057590574,0.06804744,0.047571912,-0.007853664,-0.010906105,0.06948617,-0.0348789,-0.022345928,0.007997481,0.050366186,-0.020816917,0.016640684,-0.019931035,-0.016445464,0.015286973,-0.0046669464,-0.012593057,0.029158426,-0.017825408,0.027952826,0.045026455,0.03894263,0.004987839,0.006336508,-0.025271796,-0.02376506,0.037114173,-0.019876055,0.03198855,-0.017697137,-0.03618518,-0.056535587,0.004505033,0.010948194,0.0100383395,0.023287006,0.058204338,0.04084174,0.033694297,-0.0032952842,0.022933347,0.0165945,0.045409027,0.022611806,-0.017512307,0.00076201797,-0.006052054,-0.01457199,-0.032884665,-0.045774687,0.013001179,-0.042901352,0.003803638,0.02262971,0.042386796,0.009666824,-0.030975346,-0.02671757,-0.0049767774,-0.016982878,0.05173126,0.0337825,-0.019432023,-0.061094232,-0.025758537,-0.026678769,0.022259561,0.026775686,-0.023594568,0.01748037,-0.01920978,-0.007730488,-0.015024077,0.011329803,-0.041222136,0.020300336,-0.07847678,-0.03634002,-0.03905111,0.036007367,0.08833899,0.09308987,0.08156635,-0.024654381,0.10376287,-0.028834477,-0.0070252074,-0.024243327,-0.043945488,0.023974719,0.0016818345,0.017465886,-0.012366681,0.019473815,0.012417997,0.044131227,0.008220747,0.036579136,0.03680642,-0.017825985,0.030222869,-0.021999985,0.039828066,0.04393186,0.03827697,0.030988375,-0.008764793,0.031098718,0.0061004846,0.023774069,-0.015011698,0.010758857,0.026473185,0.103858516,0.047574386,-0.020042526,-0.002772113,0.014344193,-0.013720301,-0.01341272,-0.0008406431,0.02700094,0.035002615,0.05826903,-0.016718939,-0.06194672,0.022860048,0.018739754,-0.019782688,0.00021674007,0.0069332425,-0.008295039,0.025301317,-0.028592465,0.003992766,0.026780745,-0.035036262,-0.005378741,0.038531173,-0.04001965,0.023503708,-0.05268028,-0.047513314,-0.0023449776,0.021129332,0.015394323,0.02134561,-0.00936449,0.033100292,0.001375895,-0.03127429,-0.04598791,0.0036458627,-0.0631408,0.03632064,-0.024981562,0.06178644,0.040049497,0.042779524,-0.013114455,0.04264775,0.034316365,-0.022038959,0.0071079745,0.042527948,-0.044970725,0.035025742,-0.02475469,0.03466135,0.009015528,-0.10312668,0.005265331,-0.03376902,0.02136646,0.025855437,0.004834717,0.040835008,0.02672923,-0.000726307,-0.011714405,0.008915918,-0.015975067,0.041821677,0.030738795,0.00064244424,-0.0062692254,0.020893857,0.0148061225,0.029216195,-0.009082247,0.031810317,0.008832847,0.008770035,-0.018925428,0.0054087085,0.047518577,-0.009610884,-0.04881285,0.013087899,-0.033067085,0.06366425,-0.028085995,0.017244756,0.04279503,-0.0756493,-0.00036419297,-0.016148467,-0.0064348513,0.027011342,-0.03909313,0.005103575,-0.055166874,-0.011719941,-0.048652716,-0.01674328,-0.0170593,0.01206826,0.09199801,-0.0484508,0.019226912,0.0010638514,-0.013823861,-0.0015467729,-0.08952581,0.06225236,0.0032373872,0.015244635,0.021115037,-0.016184561,-0.03112814,-0.010367871,-0.0065201735,0.09621409,0.006641523,-0.057640444,0.014364707,0.02986301,0.004844226,0.0071549565,-0.031825747,0.016738407,0.0032699544,0.010782117,0.027919289,-0.004358077,-0.066336334,0.052098565,-0.049743574,-0.0080010025,0.09485453,0.011295411,-0.03964986,-0.032018524,0.025343826,-0.018326523,0.018764243,-0.042970717,-0.049051806,-0.07862185,0.07369623,-0.030613171,0.010249151,0.059571683,0.01656697,0.04413175,-0.014756708,0.04332245,0.018454371,0.012053577,0.008103756,0.04942907,-0.0476561,-0.072500214,0.0013784046,0.050542884,-0.008744671,0.022444589,0.059588566,-0.058217447,-0.01712598,0.017103678,0.012664045,0.015930016,0.020911817,0.05121608,0.02927903,0.014244021,-0.01443117,-0.034781627,-0.0018704165,-0.03674104,-0.022236027,0.051638007,-0.010591936,-0.021409694,-0.020899404,0.007310903,0.0036407362,-0.0069061704,-0.010520661,-0.026813827,0.062945426,-0.010209732,-0.024526816,-0.009076064,-0.0007370426,0.027242193,-0.0073246914,0.011447312,0.03262231,-0.05525064,-0.005109242,0.02932998,0.012450764,0.03901329,-0.01692619,0.0010426274,-0.011309047,-0.0037129936,-0.017636085,0.019922063,0.012004548,0.055432763,-0.0026098352,-0.0015448192,0.038578324,-0.023851205,0.07679634,-0.041901365,0.037723355,0.0028524913,-0.01152587,-0.0053097345,-0.026335267,-0.0313482,0.008034525,0.020520449,-0.011405647,0.06714362,0.049825083,-0.006211107,0.004979499,-0.032804836,-0.014048528,0.018274626,0.015155136,-0.0037017867,-0.033104647,-0.026528705,-0.021518752,0.061497584,0.033418637,0.02158317,-0.046721283,0.057869453,0.00006243193,0.044768073,0.047055274,0.01333755,0.06590771,-0.00148967,0.0029205217,0.0036130014,0.051363066,0.027306193,-0.008601285,0.03999931,0.015566663,0.03977001,0.060785968,-0.0543484,0.052387845,0.056011878,-0.00015211882,-0.035414133,0.025505107,-0.019495804,-0.013317909,-0.047024373,0.04850441,-0.045350533,0.0038431415,-0.0017526448,-0.031088566,-0.04233737,-0.05435963,-0.0017645827,-0.024066946,-0.027209766,-0.025746867,-0.01477348,0.0032764096,0.01936628,-0.02026665,0.00078639365,0.0042766943,-0.05684267,-0.025144575,-0.024413439,0.042760834,0.0033773899,-0.0014015092,-0.059600346,0.036848094,-0.050150782,-0.006987694,-0.024111087,-0.042180747,0.084381424,0.025981128,0.031135542,0.020456048,0.05137682,-0.03540536,-0.0048006065,0.05843057,0.052495908,-0.030911665,0.0067075826,0.040953342,0.03474718,-0.04327372,0.0321601,0.04064377,-0.052394588,-0.020194855,0.06750737,-0.02436297,0.0026617362,0.038259212,0.052039016,-0.04325862,-0.013855287,-0.012207563,0.027423775,-0.036502372,-0.0031812433,0.037190773,-0.022488972,-0.015420919,-0.0052459617,0.018980972,-0.0012554032,-0.006195331,0.030443015,0.037329417,0.019456515,0.01136449,-0.040299837,0.03606099,0.029108526,0.0060463054,0.007735861,-0.013185317,-0.040008653,0.015491322,-0.03938893,0.0029613485,-0.09181011,0.012427564,-0.010378958,0.07054226,-0.018632669,-0.022141932,-0.054689158,-0.030682286,0.015263349,0.027904846,0.02758222,0.024451695,0.055982746,-0.017934766,0.046248052,0.001608398,-0.033908214,0.018013861,-0.006164523,-0.011119387,-0.0059176725,0.005880351,-0.036072385,-0.036668994,-0.0458429,-0.024065321,-0.014339884,-0.020234482,0.00874883,-0.009690278,-0.015870966,0.015092341,-0.026170352,-0.021914506,-0.016775968,0.023935322,-0.030444082,0.0031840433,-0.028202977,0.0010267932,0.035418604,0.05370065,0.00075183314,0.041502498,0.007442206,-0.054802798,0.040289376,0.026405834,-0.013130533,0.007366057,-0.08186521,-0.031462498,-0.02947452,0.034178838,-0.0289417,0.021730283,-0.025580944,0.01598808,-0.04733153,-0.039338544,-0.020151401,0.013491109,-0.018268079,-0.024348807,0.043350365,-0.0051059946,0.018747767,-0.07018972,0.033572014,-0.029819258,-0.0048003434,-0.051243342,-0.02956135,-0.03365333,-0.052892275,-0.0034149867,-0.004630659,-0.024776356,-0.0030904051,0.06757139,-0.04728025,0.018557444,-0.02604661,0.018229362,0.050134897,0.005451952,-0.040144615,-0.016479896,0.029917512,0.014318914,0.043078598,0.08060593,0.08247212,-0.016394122,0.011791613,0.037295118,-0.021225533,-0.024810681,0.0010223162,-0.011130623,-0.0068665175,-0.012189674,0.061898522,0.01945762,-0.035148628,-0.04983595,-0.03948717,-0.046102136,0.012048953,0.061936233,0.017765079,-0.030698292,0.0094654225,0.010257938,-0.010323905,-0.047282252,0.03916255,0.010843823,0.01688077,0.014288935,-0.0042389454,0.006329101,-0.0903361,-0.09106253,0.009360537,0.026007913,0.037509505,0.04387355,0.014151022,0.025194254,0.03621871,0.014654309,0.0005946335,-0.0029071756,-0.015689166,-0.059161376,0.035818547,0.02011936,-0.012638938,0.011605603,-0.03645752,-0.013105729,-0.023523536,0.018029891,-0.003129815,-0.0556401,-0.103258185,-0.021539968,-0.016337566,-0.0053592124,0.052532565,-0.018509965,-0.011920395,-0.024836805,0.023861181,0.05314602,-0.057249747,-0.03671859,-0.031688012,0.0820732,0.0005479938,-0.007806163,-0.041072622,-0.020238947,0.030835992,0.068623744,0.0057832636,0.021658719,-0.019103203,-0.06436901,-0.028302351,-0.051327713,-0.0058386857,0.02915496,0.015300594,-0.0038817793,-0.04585605,-0.025391156,-0.01785644,-0.035297293,-0.04175674,0.03535971,0.000044321805,-0.0074099447,0.022146747,0.046122618,0.03932414,-0.010538097,-0.017374802,-0.006874264,-0.02772555,-0.012098783,0.060019266,-0.015884297,0.046257593,0.009153706,-0.0008394667,0.044468384,-0.0068895738,-0.02548003,0.01220307,-0.007513124,-0.060039237,-0.036832146,-0.01934524,0.01919445,0.0112028,-0.021161877,-0.015834497,-0.0057202806,-0.038629953,0.011229302,-0.000750935,0.041124605,-0.030439971,-0.07448231,-0.007470088,0.010210687,0.018832346,-0.054735765,0.03923166,0.0037381325,0.08634127,-0.02237453,0.0644506,-0.042010996,-0.06446537],
        limit=10,
        query_filter=models.Filter(
            must=[
                models.FieldCondition(
                    key="error_code",
                    match=models.MatchValue(value="HTTP:INTERNAL_SERVER_ERROR")
                )
            ]
        )
    )
    print(result)'''
        
        
    
    

 
